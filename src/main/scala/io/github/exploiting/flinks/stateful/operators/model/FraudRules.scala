package io.github.exploiting.flinks.stateful.operators.model

object FraudRules {

  def inputIsFraudulent[Event](detector: Event => Boolean)(in: Event): Boolean =
    detector(in)

  def scoreFlyingCarpet(input: { val customerSpeed: Double }): Boolean =
    input.customerSpeed > 1000.0

  def deriveSpeed(currentLocation: (Double, Double), currentTime: Long, previousEntry: Option[(Long, (Double, Double))]): Double =
    previousEntry match {
      case None => 0.0
      case Some(prev) => 1000.0 //TODO
    }

  def standardDeviation(list: Seq[Int]): Double =
    if (list.length > 2) Math.sqrt(list.sum / (list.length - 1)) else 0.0

  def mean(list: Seq[Int]): Double =
    if (list.nonEmpty) list.sum / list.length else 0.0

  def twiceStdDevPredicate(history: Seq[Int]): Int => Boolean = in =>
    in > mean(history) + (2 * standardDeviation(history)) ||
    in < mean(history) - (2 * standardDeviation(history))

  
}
