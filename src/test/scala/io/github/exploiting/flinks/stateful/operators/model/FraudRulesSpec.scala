package io.github.exploiting.flinks.stateful.operators.model

import org.scalatest.{Matchers, WordSpec}

class FraudRulesSpec extends WordSpec with Matchers {
  "FraudRules" should {
    val amsterdam: Location = (52.378455, 4.899814)
    val newYork: Location = (40.707312, -74.010957)

    "calculate the distance correctly" in {
      val distance = FraudRules.calculateDistance(amsterdam, newYork)
      distance should equal (5863.23 +- 0.01)
    }

    "calculate the speed correctly" in {
      val endTime = System.currentTimeMillis()
      val startTime = endTime - 4 * 3600 * 1000

      val speed = FraudRules.deriveSpeed(newYork, endTime, amsterdam, startTime)
      speed should equal (1465.80 +- 0.01)
    }
  }
}
