package io.github.exploiting.flinks.stateful.operators

import org.scalatest.{Matchers, WordSpec}
import stateful_fc.History

class HistoryTest extends WordSpec with Matchers {

  "The history type" should {
    "store items that are coming in" in {
      val init = History[Int](10)

      val result = init :+ 1 :+ 2 :+ 3

      result.buffer.size shouldBe 3
      result.buffer shouldBe Vector(1,2,3)
    }

    "overwrite items when limit is reached" in {
      val init = History[Int](2)

      val result = init :+ 1 :+ 2 :+ 3
      result.buffer.size shouldBe 2
      result.buffer shouldBe Vector(2,3)
    }

    "completely overwrite items" in {
      val init = History[Int](2)

      val result = init :+ 1 :+ 2 :+ 3 :+ 4 :+ 5
      result.buffer.size shouldBe 2
      result.buffer shouldBe Vector(4,5)
    }
  }
}
